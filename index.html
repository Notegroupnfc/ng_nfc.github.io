<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NFC Scan</title>
<style>
body { font-family: Arial; text-align:center; padding:40px; }
#status { font-size:18px; margin-top:20px; }
</style>
</head>
<body>
<h2>üì° NFC Scan</h2>
<p id="status">ƒêang x·ª≠ l√Ω data.csv...</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvURL = "https://raw.githubusercontent.com/Notegroupnfc/ng_nfc.github.io/main/data.csv";
let csvData = {};

Papa.parse(csvURL, {
  download: true,
  header: true,
  skipEmptyLines: true,
  complete: function(results) {
    results.data.forEach(row => {
      if(row.ID) {
        csvData[row.ID] = {
          TEN_TOA_NHA: row.TEN_TOA_NHA,
          LINK: row.LINK
        };
      }
    });
    document.getElementById("status").innerText = "CSV ƒë√£ t·∫£i th√†nh c√¥ng!";
    redirectByID();
  },
  error: function(err) {
    document.getElementById("status").innerText = "‚ùå Kh√¥ng t·∫£i ƒë∆∞·ª£c data.csv";
    console.error(err);
  }
});

function redirectByID() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");
  if(!id) {
    document.getElementById("status").innerText = "‚ùå Kh√¥ng c√≥ ID!";
    return;
  }

  const info = csvData[id];
  if(info && info.LINK) {
    document.getElementById("status").innerText = `ƒêang chuy·ªÉn h∆∞·ªõng t·ªõi ${info.TEN_TOA_NHA}...`;
    // Redirect ngay
    window.location.href = info.LINK;
  } else {
    document.getElementById("status").innerText = "‚ùå ID kh√¥ng t√¨m th·∫•y trong CSV!";
  }
}
</script>
</body>
</html>

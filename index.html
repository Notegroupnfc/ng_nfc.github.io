<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script src="cdnjs.cloudflare.com"></script>
</head>
<body>
  <div style="padding: 20px; text-align: center; font-family: sans-serif;">
    <h3>Tải lên data.csv</h3>
    <input type="file" id="csvFile" accept=".csv"><br><br>
    <button onclick="upload()" style="padding: 10px 20px;">GHI NHẬT KÝ</button>
    <p id="msg"></p>
  </div>

  <script>
    function upload() {
      const file = document.getElementById('csvFile').files[0];
      const msg = document.getElementById('msg');
      if (!file) { alert("Chọn file trước!"); return; }

      msg.innerText = "Đang xử lý...";
      Papa.parse(file, {
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          google.script.run
            .withSuccessHandler(res => { 
                msg.innerText = res; 
                document.getElementById('csvFile').value = ""; 
            })
            .processDataFromCSV(results.data);
        }
      });
    }
  </script>
</body>
</html>

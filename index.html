<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Generate NFC URLs</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
</head>
<body>
<h2>Generate NFC Tag URLs từ CSV</h2>
<input type="file" id="csvFile" accept=".csv" />
<br><br>
<button id="generateBtn">Tạo URL NFC</button>
<br><br>
<textarea id="output" style="width:100%; height:300px;"></textarea>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxemlxIMJtagonvW6J5Sw9aR1OSunif_150wmJaw6efKiU-4k7huIbfCS-Bkmcq9WmY/exec";

document.getElementById('generateBtn').onclick = () => {
  const fileInput = document.getElementById('csvFile');
  if (!fileInput.files.length) {
    alert("Chọn CSV trước!");
    return;
  }
  const file = fileInput.files[0];

  Papa.parse(file, {
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
      const data = results.data;
      const urls = data.map(r => {
        const id = encodeURIComponent(r.ID || "");
        const links = encodeURIComponent(r.LINKS || "");
        const toa_nha = encodeURIComponent(r.TOA_NHA || "");
        return `${WEB_APP_URL}?id=${id}&links=${links}&toa_nha=${toa_nha}`;
      });
      document.getElementById('output').value = urls.join("\n");
      alert("Tạo xong! Copy các URL để ghi vào NFC tag.");
    }
  });
};
</script>
</body>
</html>
